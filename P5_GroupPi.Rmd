---
title: "P5 GroupPi"
geometry: margin=0.9in
output:
  pdf_document:
    highlight: tango
    toc_depth: 2
  word_document:
    toc_depth: '2'
subtitle: CS4831
fontsize: 11pt
---
Group Pi  
Members: Jordan DeYonker, Lydia Savatsky, and Alan Bouwman

Packages used in this assignment:
```{r packages, message = FALSE, warning = FALSE, attr.source='.numberLines'}
library(ggplot2)
library(tm)
library(stopwords)
```

#Q4
Reading in the college data.
```{r, eval = TRUE}
college <- read.csv("p5-data/college_data.csv")
#View(college)
```

## Q4 (a)
Performing PCA on college data.
```{r, eval = TRUE}
pc <- prcomp(college[4:21], scale = T)
pc$rotation[,1:4]
```

## Q4 (b)
Plotting the data in the space defined by the first two Pcs.
```{r, eval = TRUE}
biplot(pc, scale = 0, xlabs = rep(".", dim(pc$x)[1]))
```

## Q4 (c) 
Plotting the amount of variance explained
```{r, eval = TRUE}
pve = pc$sdev^2/sum(pc$sdev^2)
pve

plot(pve, xlab = "Principal Components", ylab = "Proportion of Variance Explained", ylim = c(0,1), type='b')

plot(cumsum(pve), xlab = "Principal Components", ylab = "Proportion of Cumulative Proportion of Variance Explained", ylim = c(0,1), type='b')
```
[FILL IN] complonets should be used for further analysis to be done on the data.

# Q5
Reading in the stock data.
```{r, eval = TRUE}
stock19 <- read.csv("p5-data/stock_data_2019.csv")
stock20 <- read.csv("p5-data/stock_data_2020.csv")
#View(stock19)
#View(stock20)
```

## Q5 (a)
Performing PCA on DOW Jones 2020 data.
```{r, eval = TRUE}
pc20 <- prcomp(stock20[2:31], scale = T)
pc20$rotation[,1:4]
```

## Q5 (b)
Plotting the data in the space defined by the first two PCs.
```{r, eval = TRUE}
biplot(pc20, scale = 0, xlabs = rep(".", dim(pc1$x)[1]))
```

## Q5 (c)
[FILL IN]

## Q5 (d)
Performing PCA on DOW Jones 2019 data.
```{r, eval = TRUE}
pc19 <- prcomp(stock19[2:31], scale = T)
pc19$rotation[,1:4]

biplot(pc19, scale = 0, xlabs = rep(".", dim(pc19$x)[1]))
```
[FILL IN]

# Q6

## Q6 (a)
Importing the data.
```{r, eval = TRUE}
dsrc <- DirSource("p5-data/sotu/files")
address <- Corpus(dsrc, readerControl=list(language="en"))
#summary(address)

party <- read.table("p5-data/sotu/party.txt", sep =",", header = F)
colnames(party) <- c("Party", "Pres", "Year")
View(party)
```

## Q6 (b)
Removing stopwords.
```{r, eval = TRUE}
stopwords <- read.table("p5-data/sotu/stopwords.txt", header = F)

##Change to stopwords.txt
address <- tm_map(address, removeWords, stopwords("english"))
```

## Q6 (c) (i)
Creating a term-document matrix. 
```{r, eval = TRUE}

```

## Q6 (c) (ii)
Determining the party affiliations of the president using the Bernoulli model of NB. 
```{r, eval = TRUE}

```

## Q6 (c) (iii)
Determining the party affiliations of the president using the Multinomial model of NB. 
```{r, eval = TRUE}

```